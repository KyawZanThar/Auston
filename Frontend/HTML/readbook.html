<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Read Book - Auston</title>
  <style>
    /* Reset & base */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f8f9fb;
      color: #1a1a1a;
      height: 100vh;
      display: flex;
    }
    img {
      display: block;
      max-width: 100%;
      height: auto;
    }
    button {
      cursor: pointer;
      border: none;
      outline: none;
      background: none;
    }
    a {
      text-decoration: none;
      color: inherit;
    }

    /* Sidebar */
    .sidebar {
      width: 220px;
      background-color: #14213d;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 20px 0;
      flex-shrink: 0;
    }
    .sidebar .logo {
      font-weight: 700;
      font-size: 24px;
      color: #fca311;
      padding-left: 20px;
      margin-bottom: 40px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .sidebar .logo svg {
      width: 24px;
      height: 24px;
      fill: #fca311;
    }
    .sidebar nav {
      flex-grow: 1;
    }
    .sidebar nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .sidebar nav ul li {
      padding: 14px 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    /* Highlight Category as active */
    .sidebar nav ul li[data-menu="category"],
    .sidebar nav ul li[data-menu="category"]:hover {
      background-color: #fca311;
      color: #14213d;
      border-radius: 6px 0 0 6px;
    }
    .sidebar nav ul li svg {
      width: 20px;
      height: 20px;
      fill: none;
      stroke: currentColor;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .sidebar .bottom-menu {
      border-top: 1px solid #2a2f4a;
      padding-top: 20px;
    }
    .sidebar .bottom-menu ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .sidebar .bottom-menu ul li {
      padding: 14px 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .sidebar .bottom-menu ul li:hover {
      background-color: #fca311;
      color: #14213d;
      border-radius: 6px 0 0 6px;
    }
    .sidebar .bottom-menu ul li svg {
      width: 20px;
      height: 20px;
      fill: none;
      stroke: currentColor;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    /* Main content */
    .main-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      background: #fff;
      overflow: hidden;
      height: 100vh;
    }

    /* Top bar */
    .top-bar {
      background-color: #14213d;
      padding: 12px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      color: white;
      flex-shrink: 0;
    }
    .top-bar .logo {
      color: #fca311;
      font-weight: 700;
      font-size: 24px;
      display: none;
    }
    .top-bar input[type="search"] {
      width: 100%;
      max-width: 600px;
      padding: 10px 16px;
      border-radius: 12px;
      border: none;
      font-size: 16px;
      outline: none;
    }
    .top-bar .profile {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      position: relative;
    }
    .top-bar .profile img {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #fca311;
    }
    .top-bar .profile span {
      font-weight: 600;
      font-size: 16px;
    }
    .top-bar .profile::after {
      content: "▼";
      font-size: 10px;
      margin-left: 4px;
      color: #fca311;
    }

    /* Breadcrumb */
    .breadcrumb {
      padding: 12px 32px;
      background: #f0f0f0;
      font-size: 14px;
      color: #555;
      user-select: none;
    }
    .breadcrumb a {
      color: #14213d;
      font-weight: 600;
      text-decoration: none;
      margin-right: 6px;
    }
    .breadcrumb a:hover {
      text-decoration: underline;
    }
    .breadcrumb span {
      margin-right: 6px;
      color: #999;
    }

    /* Content area */
    .content-area {
      display: flex;
      flex-grow: 1;
      overflow: hidden;
      padding: 24px;
      gap: 32px;
    }

    /* Book reading panel */
    .book-panel {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      max-width: 900px;
      margin: 0 auto;
      width: 100%;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.05);
      overflow: hidden;
    }

    /* Top book info with blue background */
    .book-info {
      background-color: #14213d;
      color: white;
      padding: 24px 32px;
      display: flex;
      gap: 32px;
      align-items: center;
      flex-wrap: wrap;
    }
    .book-info img {
      width: 160px;
      height: 220px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 6px 12px rgb(0 0 0 / 0.15);
      flex-shrink: 0;
    }
    .book-meta {
      flex: 1;
      min-width: 280px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .book-meta h1 {
      margin: 0;
      font-size: 28px;
      font-weight: 700;
      line-height: 1.2;
    }
    .book-meta .author {
      font-size: 18px;
      font-weight: 600;
      color: #fca311;
      margin: 0;
    }
    .rating-fav {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-top: 8px;
      flex-wrap: wrap;
    }
    .rating {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .rating svg {
      width: 20px;
      height: 20px;
      fill: #fca311;
    }
    .rating .rating-value {
      font-weight: 600;
      font-size: 16px;
      color: white;
    }
    .fav-buttons {
      display: flex;
      gap: 16px;
    }
    .fav-buttons button {
      background: transparent;
      border: 2px solid white;
      border-radius: 8px;
      padding: 8px 16px;
      color: white;
      font-weight: 600;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    .fav-buttons button svg {
      width: 18px;
      height: 18px;
      stroke: white;
      stroke-width: 2;
      fill: none;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .fav-buttons button:hover {
      background-color: white;
      color: #14213d;
    }
    .fav-buttons button.active {
      background-color: #fca311;
      border-color: #fca311;
      color: #14213d;
    }
    .fav-buttons button.active svg {
      stroke: #14213d;
      fill: #14213d;
    }

    /* Description area */
    .description-container {
      flex-grow: 1;
      padding: 24px 32px;
      overflow-y: auto;
      font-size: 16px;
      line-height: 1.6;
      color: #1a1a1a;
      background: white;
    }
    .description-container p {
      margin-bottom: 1em;
    }

    /* Scrollbar styling for description */
    .description-container::-webkit-scrollbar {
      width: 8px;
    }
    .description-container::-webkit-scrollbar-thumb {
      background: #fca311;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <aside class="sidebar" role="navigation" aria-label="Main sidebar">
    <div class="logo">
      AUSTON
      <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M3 21L21 12 3 3v18z" fill="#fca311"/>
      </svg>
    </div>
    <nav>
      <ul>
        <li data-menu="home" aria-label="Home">
          <a href="dashboard.html" style="display: flex; align-items: center; gap: 12px; width: 100%;">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M3 9.5L12 3l9 6.5v11a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1v-11z" />
            </svg>
            Home
          </a>
        </li>
        <li data-menu="category" aria-label="Category" class="active">
          <a href="category.html" style="display: flex; align-items: center; gap: 12px; width: 100%;">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <rect x="3" y="3" width="7" height="7" />
              <rect x="14" y="3" width="7" height="7" />
              <rect x="14" y="14" width="7" height="7" />
              <rect x="3" y="14" width="7" height="7" />
            </svg>
            Category
          </a>
        </li>
        <li data-menu="activity" aria-label="My Activity">
          <a href="myactivity.html" style="display: flex; align-items: center; gap: 12px; width: 100%;">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M3 12h18M3 6h18M3 18h12" />
            </svg>
            My Activity
          </a>
        </li>
        <li data-menu="audio" aria-label="Audio Books">
          <a href="audiobooks.html" style="display: flex; align-items: center; gap: 12px; width: 100%;">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <circle cx="12" cy="12" r="10" />
              <path d="M9 9v6l5-3-5-3z" />
            </svg>
            Audio Books
          </a>
        </li>
        <li data-menu="mybooks" aria-label="My Books">
          <a href="mybooks.html" style="display: flex; align-items: center; gap: 12px; width: 100%;">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M4 19h16v-14H4v14zM4 5h16" />
              <path d="M8 9h8M8 13h8M8 17h5" />
            </svg>
            My Books
          </a>
        </li>
      </ul>
    </nav>
    <div class="bottom-menu">
      <ul>
        <li data-menu="setting" aria-label="Setting">
          <a href="setting.html" style="display: flex; align-items: center; gap: 12px; width: 100%;">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <circle cx="12" cy="12" r="3" />
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33h.09a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51h.09a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z" />
            </svg>
            Setting
          </a>
        </li>
        <li data-menu="support" aria-label="Support">
          <a href="support.html" style="display: flex; align-items: center; gap: 12px; width: 100%;">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <circle cx="12" cy="12" r="10" />
              <path d="M12 16v-4M12 8h.01" />
            </svg>
            Support
          </a>
        </li>
        <li data-menu="logout" aria-label="Logout">
          <a href="register.html" style="display: flex; align-items: center; gap: 12px; width: 100%;">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M16 17l5-5-5-5M21 12H9M13 19H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h8" />
            </svg>
            Logout
          </a>
        </li>
      </ul>
    </div>
  </aside>

  <main class="main-content" role="main">
    <header class="top-bar">
      <div class="logo" style="color: #fca311; font-weight: 700; font-size: 24px; display:none;">AUSTON</div>
      <input type="search" placeholder="Search books here" aria-label="Search books" />
      <div class="profile" tabindex="0" aria-haspopup="true" aria-expanded="false">
        <img src="https://i.pravatar.cc/150?img=47" alt="User profile picture" />
        <span>Emily</span>
      </div>
    </header>

    <!-- Breadcrumb added here -->
    <nav class="breadcrumb" aria-label="Breadcrumb" style="padding: 12px 32px; background: #f0f0f0; font-size: 14px; color: #555; user-select: none;">
      <a href="dashboard.html" style="color: #14213d; font-weight: 600; text-decoration: none; margin-right: 6px;">Home</a>
      <span style="margin-right: 6px; color: #999;">›</span>
      <a href="category.html" style="color: #14213d; font-weight: 600; text-decoration: none; margin-right: 6px;">Category</a>
      <span style="margin-right: 6px; color: #999;">›</span>
      <span aria-current="page" style="color: #999;">Read Book</span>
    </nav>

    <section class="content-area">
      <section class="book-panel" aria-label="Book reading panel">
        <div class="book-info" id="book-info">
          <!-- Book cover, title, author, stars, fav, bookmark -->
        </div>
        <div class="description-container" id="description-container" tabindex="0" aria-label="Book description">
          <!-- Book description text -->
        </div>
      </section>
    </section>
  </main>

 <!-- In: readbook.html (at the bottom of the <body> tag) -->

<!-- 1. Include your config file for consistency -->
<script src="../config/appConfig.js"></script>

<!-- 2. The main script for this page -->
<script>
    // Helper to create star rating SVGs (this function is correct)
    function createStarRating(rating) {
        // ... same as your existing function ...
        const stars = [];
        for (let i = 0; i < 5; i++) {
            stars.push(`<svg ... ${i < rating ? 'fill="#fca311"' : 'fill="#ddd"'} ...>...</svg>`);
        }
        return stars.join("");
    }

    // --- MAIN LOGIC ---
    document.addEventListener('DOMContentLoaded', function() {
        const bookInfoDiv = document.getElementById('book-info');
        const descriptionDiv = document.getElementById('description-container');

        // Load book from localStorage
        let book = null;
        try {
            book = JSON.parse(localStorage.getItem('selectedBook'));
        } catch (e) {
            console.error("Could not parse book data from localStorage.", e);
        }

        if (!book) {
            bookInfoDiv.innerHTML = '<p style="color: white; padding: 2rem;">No book selected. Please go back to the dashboard and select a book.</p>';
            descriptionDiv.style.display = 'none';
        } else {
            // --- RENDER BOOK INFO ---
            // Use default values if properties are missing
            const rating = book.ratings || 4;
            const coverUrl = book.img || book.coverUrl || 'https://placehold.co/160x220/14213d/fca311?text=No+Image';

            bookInfoDiv.innerHTML = `
                <img src="${coverUrl}" alt="${book.title} cover" />
                <div class="book-meta">
                    <h1>${book.title}</h1>
                    <p class="author">${book.author}</p>
                    <div class="rating" aria-label="Rating: ${rating} out of 5 stars">
                        ${createStarRating(rating)}
                        <span class="rating-value">${rating}</span>
                    </div>
                    <div class="fav-buttons">
                        <button id="fav-btn" aria-pressed="false" aria-label="Add to favorites">
                            <svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" /></svg>
                            Favorite
                        </button>
                        <button id="bookmark-btn" aria-pressed="false" aria-label="Add to bookmarks">
                            <svg viewBox="0 0 24 24"><path d="M6 4h12v16l-6-4-6 4V4z" /></svg>
                            Bookmark
                        </button>
                    </div>
                </div>
            `;

            // --- RENDER DESCRIPTION & PDF LINK ---
            descriptionDiv.innerHTML = `<p>${book.description}</p>`;

            // Get the unique ID for the book (prefer the database ID '_id')
            const bookId = book._id || book.id || book.bookId;

            if (bookId) {
                const link = document.createElement('a');
                // Set the href to openpdf.html and pass the book's ID as a URL parameter.
                link.href = `openpdf.html?bookId=${bookId}`;
                link.target = '_blank'; // Open in a new tab
                link.innerText = 'Open PDF in Reader';
                link.style = 'display:inline-block; margin-top:12px; background:#14213d; color:#fff; padding:8px 12px; border-radius:6px; text-decoration:none;';
                descriptionDiv.appendChild(link);
            }

            // --- ADD EVENT LISTENERS ---
            const favBtn = document.getElementById('fav-btn');
            const bookmarkBtn = document.getElementById('bookmark-btn');
            if(favBtn) {
                favBtn.addEventListener('click', () => {
                    favBtn.classList.toggle('active');
                });
            }
            if(bookmarkBtn) {
                bookmarkBtn.addEventListener('click', () => {
                    bookmarkBtn.classList.toggle('active');
                });
            }
        }
    });
</script>
</body>
</html>

